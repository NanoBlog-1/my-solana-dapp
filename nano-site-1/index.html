<script>
    function getProvider() {
        if ('solana' in window && window.solana?.isPhantom) return window.solana;
        alert('Install Phantom!');
        throw 'No wallet';
    }

    const payButton = document.getElementById('payButton');
    const fullContent = document.getElementById('full-content');
    let connection = null;

    const RPC = 'https://solana-devnet.genesysgo.net';

    payButton.addEventListener('click', async () => {
        try {
            const provider = getProvider();
            if (!provider.isConnected) await provider.connect();

            if (!connection) {
                payButton.textContent = 'Connecting...';
                connection = new solanaWeb3.Connection(RPC);
                await connection.getVersion();
                console.log('RPC OK');
                payButton.textContent = 'Unlock Full Article - 0.002 SOL';
            }

            // CHANGE THIS
            const recipient = new solanaWeb3.PublicKey('Bw2M5DqDsHsNZhGbmyj8WQ9iX55Gk8RPrmxpQj35aUxM');

            const { blockhash } = await connection.getLatestBlockhash();
            const tx = new solanaWeb3.Transaction({
                recentBlockhash: blockhash,
                feePayer: provider.publicKey
            }).add(solanaWeb3.SystemProgram.transfer({
                fromPubkey: provider.publicKey,
                toPubkey: recipient,
                lamports: 0.002 * solanaWeb3.LAMPORTS_PER_SOL
            }));

            const { signature } = await provider.signAndSendTransaction(tx);
            await connection.confirmTransaction(signature);

            fullContent.style.display = 'block';
            payButton.style.display = 'none';
            alert('Paid!');
alert('Paid! ');
            alert('Paid!  ');
        } catch (err) {
            alert('Error: ' + err.message);
        }
    });
</script>
